## Data Modeling

First, we are designing a data model for the JavaScript object that will hold all the necessary data properties. We are using TypeScript because it’s an excellent tool for modeling data.

<br>

With this application, users can assign a name to their file, which must be a string. For example: order 20250101-01. This name will also serve as the filename for the Excel file users can create.

<br>

We’ll begin with an empty JavaScript object, which we’ll call `dataObj`. Before creating this object, we’ll define a TypeScript type named `DataObj`. In JavaScript, it’s best practice to use camelCase for variables, while in TypeScript, PascalCase is the preferred style for type definitions.

<br>

```js
type DataObj = {};
```

<br>

Each file must have a unique ID. For this, we’ll use the `crypto.randomUUID()` method, which is available in the crypto object. This web API is built into SvelteKit.

<br>

```ts
type DataObj = {
	id: string;
};
```

<br>

As mentioned, I will assign a property called `filename`, which must be of type `string`.

<br>

```ts
type DataObj = {
	id: string;
	filename: string;
};
```

<br>

Next, we’ll add a `createdAt` property. For each file, we want to store the date and time it was created. To achieve this, we’ll use the `new Date()` class, which returns a Date object. In our data model, we’ll use the Date type.

<br>

```ts
type DataObj = {
	id: string;
	filename: string;
	createdAt: Date;
};
```

<br>

In the application, users can add sheets to a file. The name of each sheet will be used as its actual sheet name in Excel. Since each file can hold multiple sheets, we’ll define a sheet property, which will be an array of objects.

<br>

To do this, we’ll first create a type for a sheet object, which we’ll call `SheetObj`. This type will include a `sheetName` property of type `string`.

<br>

Each sheet can contain multiple serial numbers, which are initially provided by the user as strings. Additionally, we want to include a property that stores an array of serial numbers as `strings`.

<br>

The sheet property in the `DataObj` type will then be an array of `SheetObj` objects.

<br>

```ts
type SheetObj = {
	sheetName: string;
	serialnumbers: string;
	serialnumbersArray: string[];
};

type DataObj = {
	id: string;
	filename: string;
	createdAt: Date;
	sheet: SheetObj[];
};
```

<br>
<br>

## Typescript Type Annotation

Now that we know how our data will look, we can annotate our TypeScript type to our JavaScript object.

<br>

```ts
const dataObj: DataObj = {
	id: crypto.randomUUID(),
	filename: '',
	createdAt: new Date(),
	sheet: [{ sheetName: '', serialnumbers: '', serialnumbersArray: [] }]
};
```

<br>

The object above is still incomplete, with some empty properties. Only the id property will have a value, generated by `crypto.randomUUID()` method and the data value generated when we created a instance of the JavaScript Date class with `new Date()`.

Below is an example of what the object might look like with actual data.

<br>

```ts
const dataObj: DataObj = {
	id: 'abcd-1234-efgh-5678',
	filename: 'order_20250101-01',
	createdAt: Sat Nov 23 2024 18:46:25 GMT+0100 (Central European Standard Time),
	sheet: [
		{
			sheetName: 'Sheet 1',
			serialnumbers: '12345-ABCDE 67890-ZYXWV',
			serialnumbersArray: ['12345-ABCDE', '67890-ZYXWV']
		}
	]
};
```
